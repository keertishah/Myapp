(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{109:function(e,t){},226:function(e,t,a){e.exports=a(555)},231:function(e,t,a){},550:function(e,t,a){},555:function(e,t,a){"use strict";a.r(t);var s=a(1),n=a.n(s),r=a(9),i=a.n(r),c=(a(231),a(61)),o=a(62),l=a(71),u=a(63),m=a(72),h=a(73),d=a.n(h),f=a(563),p=a(564),g=a(556),E={aws_project_region:"us-west-2",aws_cognito_identity_pool_id:"us-west-2:0eec694c-d342-414c-b013-f4287be80b3d",aws_cognito_region:"us-west-2",aws_user_pools_id:"us-west-2_HSNXCoZyL",aws_user_pools_web_client_id:"6qb152bgmcda8o2qevdsdid2ju",aws_user_files_s3_bucket:"imageuploads-mclinical-salaunch",aws_user_files_s3_bucket_region:"us-west-2"},v=a(562),y=a(11),I=v.a.Step,k="Welcome page",_="Keep image user decision",S="Take shot",O="Wait image to be processed",b="User is filling the form",w=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"getPhotoStatus",value:function(){switch(this.props.status){case k:return"wait";default:return"finish"}}},{key:"getStyle",value:function(){switch(this.props.status){case k:return{display:"flex"};default:return{display:"inline-flex",marginRight:"20px"}}}},{key:"getFormStatus",value:function(){switch(this.props.status){case k:case S:case _:return"wait";default:return"finnish"}}},{key:"getResultStatus",value:function(){switch(this.props.status){case k:case S:case _:case b:return"wait";case O:return"process";default:return"finnish"}}},{key:"welcomePageSteps",value:function(){return n.a.createElement(v.a,null,n.a.createElement(I,{status:"finish",title:"Deposit Checks",icon:n.a.createElement(y.a,{type:"smile"}),description:"With our new Take Picture feature deposit check from convinence of your home"}),n.a.createElement(I,{status:this.getPhotoStatus(),title:"Front picture",icon:n.a.createElement(y.a,{type:"camera"}),description:"Take a picture of front of the check"}),n.a.createElement(I,{status:this.getFormStatus(),title:"Provide check information",icon:n.a.createElement(y.a,{type:"form"}),description:"A small check questionnaire"}),n.a.createElement(I,{status:this.getResultStatus(),title:"Submit the deposit",icon:n.a.createElement(y.a,{type:"file-done"}),description:"Get your check deposited in seconds"}))}},{key:"otherPagesSteps",value:function(){return n.a.createElement(v.a,{style:{marginLeft:"25px"}},n.a.createElement(I,{style:this.getStyle(),status:"finish",icon:n.a.createElement(y.a,{type:"smile"})}),n.a.createElement(I,{style:this.getStyle(),status:this.getPhotoStatus(),icon:n.a.createElement(y.a,{type:"camera"})}),n.a.createElement(I,{style:this.getStyle(),status:this.getFormStatus(),icon:n.a.createElement(y.a,{type:"form"})}),n.a.createElement(I,{style:this.getStyle(),status:this.getResultStatus(),icon:n.a.createElement(y.a,{type:"file-done"})}))}},{key:"render",value:function(){return this.props.status===k?this.welcomePageSteps():this.otherPagesSteps()}}]),t}(s.Component),R=a(557),T=a(559),D=a(560),C=a(558),N=a(561),A=a(147),F=a.n(A),P=R.a.Item,L=(T.a.Option,D.a.Button,D.a.Group,n.a.createElement("strong",null,"Very Bad"),n.a.createElement("strong",null,"Very Good"),function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t={labelCol:{span:8},wrapperCol:{span:12}};return n.a.createElement(R.a,null,n.a.createElement(P,Object.assign({},t,{label:"Pay to the order of?"}),n.a.createElement(F.a,null)),n.a.createElement(P,Object.assign({},t,{label:"Check Amount\u2122"}),n.a.createElement(F.a,null)),n.a.createElement(P,Object.assign({},t,{label:"Date Check was Issued\u2122"}),n.a.createElement(C.a,null)),n.a.createElement(P,Object.assign({},t,{label:"Rate the service"}),n.a.createElement("span",{className:"bad"},"Bad")," ",n.a.createElement(N.a,null)," ",n.a.createElement("span",{className:"good"},"Good")),n.a.createElement(P,t,n.a.createElement(p.a,{onClick:function(){return e.props.callback()},type:"primary"},"Submit form")))}}]),t}(s.Component));a(550);d.a.configure(E),d.a.Logger.LOG_LEVEL="INFO";var x={WELCOME:"Welcome page",KEEP_IMAGE_USER_DECISION:"Keep image user decision",TAKE_SHOT:"Take shot",LOADING:"Loading",WAITING_FOR_PROCESSING:"Wait image to be processed",DISPLAY_GOOD_RESULT:"Display good news",DISPLAY_BAD_RESULT:"Display bad news",NO_CAMERA_DETECTED:"No camera on device",NO_FACE_DETECTED:"No check detected",IMAGE_DOWNLOADED:"Result image was downloaded by user",BACKEND_TIMEOUT:"Backend was too long to answer",FILL_FORM:"User is filling the form"},M={REAR:"rear cam",FRONT:"front cam",SINGLE:"there is only one cam"},G=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).waittime=0,e.videoRef=n.a.createRef(),e.canvasRef=n.a.createRef(),e.containerRef=n.a.createRef(),e.sendsound=new Audio("/sounds/send.mp3"),e.deletesound=new Audio("/sounds/trash.mp3"),e.shotsound=new Audio("/sounds/takeshot.mp3"),e.processound=new Audio("/sounds/processing.mp3"),e.processound.addEventListener("ended",function(){this.currentTime=0,this.play()},!1),e.state={stream:null,camera:M.SINGLE,fullscreen:!1,processedImage:null,filePrefix:"",status:x.WELCOME},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){h.Storage.configure({level:"private"})}},{key:"ignoreImage",value:function(){this.deletesound.play(),this.returnToCapture()}},{key:"returnToCapture",value:function(){f.a.warning("Take a clear picture of your check.",2),this.setState({stream:this.state.stream,camera:this.state.camera,fullscreen:this.state.fullscreen,processedImage:this.state.processedImage,filePrefix:this.state.filePrefix,status:x.TAKE_SHOT})}},{key:"uploadImage",value:function(e){var t=this,a=Date.now();h.Storage.put("uploads/"+a+".png",e,{contentType:"image/png"}).then(function(e){console.log("upload done"),t.setState({stream:t.state.stream,camera:t.state.camera,fullscreen:t.state.fullscreen,processedImage:t.state.processedImage,filePrefix:a,status:t.state.status}),t.waitForImageFromBackend()}).catch(function(e){return console.error(e)})}},{key:"sendDataToBackend",value:function(){this.processound.play(),this.setState({stream:this.state.stream,camera:this.state.camera,fullscreen:this.state.fullscreen,processedImage:this.state.processedImage,filePrefix:this.state.processedImage,status:x.WAITING_FOR_PROCESSING}),this.canvasRef.current.toBlob(this.uploadImage.bind(this))}},{key:"saveImage",value:function(){this.setState({stream:this.state.stream,camera:this.state.camera,fullscreen:this.state.fullscreen,processedImage:this.state.processedImage,filePrefix:this.state.processedImage,status:x.FILL_FORM})}},{key:"takeShot",value:function(){this.shotsound.play();var e=this.canvasRef.current.getContext("2d");this.canvasRef.current.width=this.videoRef.current.videoWidth,this.canvasRef.current.height=this.videoRef.current.videoHeight,e.drawImage(this.videoRef.current,0,0,this.canvasRef.current.width,this.canvasRef.current.height),this.setState({stream:this.state.stream,camera:this.state.camera,fullscreen:this.state.fullscreen,processedImage:this.state.processedImage,filePrefix:this.state.filePrefix,status:x.KEEP_IMAGE_USER_DECISION})}},{key:"startCapturingWebCam",value:function(){var e=this;console.log("Check device camera capabilities"),navigator.mediaDevices.enumerateDevices().then(function(t){return e.gotDevices(t)}).catch(function(e){return alert("enumerateDevices() error: ".concat(e.name))})}},{key:"gotDevices",value:function(e){for(var t=this,a=0,s=0;s!==e.length;++s){var n=e[s];document.createElement("option").value=n.deviceId,"videoinput"===n.kind&&(a++,console.log("Find Camera named "+n.label))}var r=M.SINGLE,i=this.state.status;switch(a){case 0:i=x.NO_CAMERA_DETECTED,console.error("This device have no camera");break;case 1:r=M.SINGLE;break;case 2:r=M.FRONT;break;default:r=M.FRONT,console.warning("Only the first two camera are used")}if(i!==x.NO_CAMERA_DETECTED){console.log("Requesting webcam access");navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then(function(e){return t.displayWebcamOutput(e)}).catch(function(e){return alert("getUserMedia() error: ".concat(e.name))})}this.setState({stream:this.state.stream,camera:r,fullscreen:this.state.fullscreen,processedImage:this.state.processedImage,filePrefix:this.state.filePrefix,status:i})}},{key:"displayWebcamOutput",value:function(e){console.log("Put stream on video HTML component"),this.videoRef.current.srcObject=e,f.a.warning("Take a clear picture of your check.",4),this.setState({stream:e,camera:this.state.camera,fullscreen:this.state.fullscreen,processedImage:this.state.processedImage,filePrefix:this.state.filePrefix,status:x.TAKE_SHOT})}},{key:"canvasStyle",value:function(){switch(this.state.status){case x.KEEP_IMAGE_USER_DECISION:case x.IMAGE_DOWNLOADED:return{display:"block"};default:return{display:"none"}}}},{key:"videoStyle",value:function(){switch(this.state.status){case x.TAKE_SHOT:return{display:"block"};default:return{display:"none"}}}},{key:"displayNewDiag",value:function(){switch(this.state.status){case x.DISPLAY_BAD_RESULT:case x.DISPLAY_GOOD_RESULT:return!0;default:return!1}}},{key:"displayClose",value:function(){switch(this.state.status){case x.IMAGE_SENT_CONFIRMATION:case x.IMAGE_DOWNLOADED:case x.BACKEND_TIMEOUT:return!0;default:return!1}}},{key:"displayError",value:function(){switch(this.state.status){case x.NO_CAMERA_DETECTED:case x.BACKEND_TIMEOUT:return!0;default:return!1}}},{key:"openFullscreen",value:function(){this.containerRef.current.requestFullscreen?this.containerRef.current.requestFullscreen():this.containerRef.current.mozRequestFullScreen?this.containerRef.current.mozRequestFullScreen():this.videoRef.current.webkitRequestFullscreen?this.containerRef.current.webkitRequestFullscreen():this.videoRef.current.msRequestFullscreen&&this.containerRef.current.msRequestFullscreen(),this.setState({stream:this.state.stream,camera:this.state.camera,fullscreen:!0,processedImage:this.state.processedImage,filePrefix:this.state.filePrefix,status:this.state.status})}},{key:"exitFullscreen",value:function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),this.setState({stream:this.state.stream,camera:this.state.camera,fullscreen:!1,processedImage:this.state.processedImage,filePrefix:this.state.filePrefix,status:this.state.status})}},{key:"changeActiveCamera",value:function(){var e=this;console.log("Switch camera");var t={audio:!1,video:{deviceId:this.state.camera===M.FRONT?{exact:0}:{exact:1}}};this.state.stream.close(),this.setState({stream:null,camera:this.state.camera===M.FRONT?M.REAR:M.FRONT,fullscreen:this.state.fullscreen,processedImage:this.state.processedImage,filePrefix:this.state.filePrefix,status:this.state.status}),navigator.mediaDevices.getUserMedia(t).then(function(t){return e.displayWebcamOutput(t)}).catch(function(e){return alert("getUserMedia() error: ".concat(e.name))})}},{key:"rotateImageLeft",value:function(){console.log("rotate image to the left")}},{key:"rotateImageRight",value:function(){console.log("rotate image to the right")}},{key:"sendByEmail",value:function(){console.log("Send by email"),this.setState({stream:this.state.stream,camera:this.state.camera,fullscreen:this.state.fullscreen,processedImage:this.state.processedImage,filePrefix:this.state.filePrefix,status:x.IMAGE_SENT_CONFIRMATION})}},{key:"downloadImage",value:function(){console.log("Download image"),this.setState({stream:this.state.stream,camera:this.state.camera,fullscreen:this.state.fullscreen,processedImage:this.state.processedImage,filePrefix:this.state.filePrefix,status:x.IMAGE_DOWNLOADED}),this.saveBase64AsFile(this.state.processedImage,"ReInvent-this.state-"+this.state.filePrefix+".png")}},{key:"saveBase64AsFile",value:function(e,t){var a=document.createElement("a");a.setAttribute("href",e),a.setAttribute("download",t),a.click()}},{key:"backendTimedOut",value:function(){console.log("Backend timed out"),this.processound.pause(),this.setState({stream:this.state.stream,camera:this.state.camera,fullscreen:this.state.fullscreen,processedImage:null,filePrefix:"",status:x.BACKEND_TIMEOUT})}},{key:"fetchImage",value:function(){var e=this;h.Storage.get("uploads/"+this.state.filePrefix+".png-UserData.json",{download:!0}).then(function(t){e.gotResultFromBackend(JSON.parse(t.Body.toString("utf-8")))}).catch(function(t){console.log("Backend haven't finish"),console.log(t),e.waittime+=2e3,e.waittime<8e3?(console.log("Launch S3 get again, time = "+e.waittime),setTimeout(e.fetchImage.bind(e),2e3)):e.backendTimedOut()})}},{key:"waitForImageFromBackend",value:function(){console.log("Wait for image"),this.waittime=0,this.fetchImage()}},{key:"gotResultFromBackend",value:function(e){var t;console.log("Got A RESULT from backend"),this.processound.pause();var a=!1,s=!1;if("undefined"!==typeof e.Labels&&e.Labels.length>0)for(t=0;t<e.Labels.length;t++)if(console.log("========= ITEM =========="),console.log(e.Labels[t]),console.log(e.Labels[t].Name),console.log(e.Labels[t].Confidence),console.log("========================="),"Person"===e.Labels[t].Name&&e.Labels[t].Confidence>=95){a=!0;var n=Math.random();console.log("random ="+n),s=n>=.75,console.log("isSick ="+s);break}var r=x.DISPLAY_GOOD_RESULT;a?s&&(r=x.DISPLAY_BAD_RESULT):r=x.NO_FACE_DETECTED,console.log("nextStatus ="+r),this.setState({stream:this.state.stream,camera:this.state.camera,fullscreen:this.state.fullscreen,processedImage:e,filePrefix:this.state.filePrefix,status:r}),console.log(e)}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{ref:this.containerRef},n.a.createElement("div",{className:"Welcome"},n.a.createElement("img",{className:"logo",src:"aws.png"})," GFS Bank"),n.a.createElement(w,{status:this.state.status}),this.state.status===x.TAKE_SHOT&&n.a.createElement(p.a,{className:"camera",type:"primary",onClick:function(){return e.takeShot()}},"Take picture"),this.state.status===x.KEEP_IMAGE_USER_DECISION&&n.a.createElement(p.a,{className:"camera",type:"primary",onClick:function(){return e.saveImage()}},"Keep this image"),this.state.status===x.KEEP_IMAGE_USER_DECISION&&n.a.createElement(p.a,{className:"camera",onClick:function(){return e.ignoreImage()}},"Delete image"),n.a.createElement("div",{className:"video-container"},n.a.createElement("video",{style:this.videoStyle(),ref:this.videoRef,muted:!0,autoPlay:!0,playsInline:!0}),n.a.createElement("canvas",{style:this.canvasStyle(),ref:this.canvasRef})),this.displayError()&&n.a.createElement("i",{className:"material-icons deco"},"mood_bad"),this.state.status===x.NO_CAMERA_DETECTED&&n.a.createElement("h1",null,"Oh no, it looks that you have no camera"),this.state.status===x.BACKEND_TIMEOUT&&n.a.createElement("h1",null,"Oh no, backend times out"),this.displayClose()&&n.a.createElement("button",{className:"btn btn-pos-3l",onClick:function(){return e.returnToCapture()}},n.a.createElement("i",{className:"material-icons"},"close")),this.state.status===x.FILL_FORM&&n.a.createElement(L,{callback:function(){return e.sendDataToBackend()}}),this.state.status===x.NO_FACE_DETECTED&&n.a.createElement("i",{className:"material-icons deco_sad"},"mood_bad"),this.state.status===x.NO_FACE_DETECTED&&n.a.createElement(g.a,{className:"marginleft",message:"Image Failure",description:"We were not able to detect your check. Please take a picture closer from the camera.",type:"error",showIcon:!0}),this.state.status===x.NO_FACE_DETECTED&&n.a.createElement(p.a,{className:"marginleft",type:"primary",onClick:function(){return e.returnToCapture()}},"Retry"),this.displayNewDiag()&&n.a.createElement(p.a,{className:"marginleft",type:"primary",onClick:function(){return e.returnToCapture()}}," Start New Deposit"),this.state.status===x.WAITING_FOR_PROCESSING&&n.a.createElement("i",{className:"material-icons deco rotate"},"hourglass_empty"),this.state.status===x.WELCOME&&n.a.createElement(p.a,{type:"primary",onClick:function(){return e.startCapturingWebCam()}},"Start my quick Deposit"))}}]),t}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(n.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[226,2,1]]]);
//# sourceMappingURL=main.07333deb.chunk.js.map